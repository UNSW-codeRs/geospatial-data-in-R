---
title: "Geospatial tutorial - section 1"
author: "JR Ferrer-Paris"
---
## Spatial autocorrelation


**Spatial autocorrelation** is a measure of how similar are observations that are close together. Here we use a **semivariogram** to describe this autocorrelation. We use functions from the `gstats` package.

### Empirical variogram

An empirical semivariogram for a spatial dataset is calculated by grouping pairs of data within bins of similar distance and then calculating their variance. 

Here, we first create an indicator variable $Z$ that represents high values of Tree cover:

$$
Z=\begin{cases}
    1, & \text{if $\mathrm{Tree\ cover}>2$}.\\
    0, & \text{otherwise}.
  \end{cases}
$$

In R we can run this:
```{r}
 data_jbm$Z <- data_jbm$`Tree cover` > 2
```

Now we apply the `variogram` function in the `gstats` package using a formula as first argument, and the data as the second argument:

```{r}
empirical_variogram <- variogram(Z ~ 1, data_jbm)
empirical_variogram
```

So for example 64 pairs of points (column `np`) are located at a mean distance of 50.66m apart (column `dist`), and have a variance of 0.179 (column `gamma`).


How many pairs of points are located at a distance of 100m? 

At what distance are the minimum and maximum values of gamma?

The default plot for this empirical variagram shows the semi-variance (`gamma`) as a function of distance (`dist`).

```{r}
plot(empirical_variogram)
```

### Variogram model

A variogram model is 

```{r}
variogram_model <- fit.variogram(empirical_variogram, 
                                 vgm(1, "Exp", 25, .20))

plot(empirical_variogram, variogram_model)
```